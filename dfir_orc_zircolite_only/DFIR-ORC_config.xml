<?xml version="1.0" encoding="utf-8"?>

<wolf childdebug="no" command_timeout="600">
    <log disposition="truncate">DFIR-ORC_{SystemType}_{FullComputerName}_{TimeStamp}.log</log>
    <outline disposition="truncate">DFIR-ORC_{SystemType}_{FullComputerName}_{TimeStamp}.json</outline>

    <archive name="DFIR-ORC_{SystemType}_{FullComputerName}_Zircolite.7z" keyword="Zircolite" concurrency="2" repeat="Once" compression="fast" archive_timeout="120" >
        <restrictions ElapsedTimeLimit="480" />
        <command keyword="GetZircolite">
            <execute name="zircolite.exe" run="7z:#Tools|zircolite.exe"/>
            <input  name='rules_windows_sysmon.json' source='res:#rules_windows_sysmon.json' argument='-r {FileName}' />
			<input  name='fieldMappings.json' source='res:#fieldMappings.json' argument='-c {FileName}' />
			<input  name='evtx_dump.exe' source='7z:#Tools|evtx_dump.exe' argument='-c {FileName}' />
            <argument>--cores 1 -e C:\windows\System32\winevt\Logs</argument>
            <output  name="detected_events.json" source="File" argument="-o {FileName}" />
            <output  name="zircolite.log" source="File" argument="-l {FileName}" />
        </command>
    </archive>

</wolf>
